"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = splitExportDeclaration;
<<<<<<< HEAD
var _t = require("@babel/types");
=======

var _t = require("@babel/types");

>>>>>>> cc2ab044b4783af66dcb103c9b0151a3a2746e60
const {
  cloneNode,
  exportNamedDeclaration,
  exportSpecifier,
  identifier,
  variableDeclaration,
  variableDeclarator
} = _t;
<<<<<<< HEAD
=======

>>>>>>> cc2ab044b4783af66dcb103c9b0151a3a2746e60
function splitExportDeclaration(exportDeclaration) {
  if (!exportDeclaration.isExportDeclaration() || exportDeclaration.isExportAllDeclaration()) {
    throw new Error("Only default and named export declarations can be split.");
  }
<<<<<<< HEAD
=======

>>>>>>> cc2ab044b4783af66dcb103c9b0151a3a2746e60
  if (exportDeclaration.isExportDefaultDeclaration()) {
    const declaration = exportDeclaration.get("declaration");
    const standaloneDeclaration = declaration.isFunctionDeclaration() || declaration.isClassDeclaration();
    const scope = declaration.isScope() ? declaration.scope.parent : declaration.scope;
    let id = declaration.node.id;
    let needBindingRegistration = false;
<<<<<<< HEAD
    if (!id) {
      needBindingRegistration = true;
      id = scope.generateUidIdentifier("default");
=======

    if (!id) {
      needBindingRegistration = true;
      id = scope.generateUidIdentifier("default");

>>>>>>> cc2ab044b4783af66dcb103c9b0151a3a2746e60
      if (standaloneDeclaration || declaration.isFunctionExpression() || declaration.isClassExpression()) {
        declaration.node.id = cloneNode(id);
      }
    }
<<<<<<< HEAD
=======

>>>>>>> cc2ab044b4783af66dcb103c9b0151a3a2746e60
    const updatedDeclaration = standaloneDeclaration ? declaration.node : variableDeclaration("var", [variableDeclarator(cloneNode(id), declaration.node)]);
    const updatedExportDeclaration = exportNamedDeclaration(null, [exportSpecifier(cloneNode(id), identifier("default"))]);
    exportDeclaration.insertAfter(updatedExportDeclaration);
    exportDeclaration.replaceWith(updatedDeclaration);
<<<<<<< HEAD
    if (needBindingRegistration) {
      scope.registerDeclaration(exportDeclaration);
    }
=======

    if (needBindingRegistration) {
      scope.registerDeclaration(exportDeclaration);
    }

>>>>>>> cc2ab044b4783af66dcb103c9b0151a3a2746e60
    return exportDeclaration;
  } else if (exportDeclaration.get("specifiers").length > 0) {
    throw new Error("It doesn't make sense to split exported specifiers.");
  }
<<<<<<< HEAD
=======

>>>>>>> cc2ab044b4783af66dcb103c9b0151a3a2746e60
  const declaration = exportDeclaration.get("declaration");
  const bindingIdentifiers = declaration.getOuterBindingIdentifiers();
  const specifiers = Object.keys(bindingIdentifiers).map(name => {
    return exportSpecifier(identifier(name), identifier(name));
  });
  const aliasDeclar = exportNamedDeclaration(null, specifiers);
  exportDeclaration.insertAfter(aliasDeclar);
  exportDeclaration.replaceWith(declaration.node);
  return exportDeclaration;
<<<<<<< HEAD
}

//# sourceMappingURL=index.js.map
=======
}
>>>>>>> cc2ab044b4783af66dcb103c9b0151a3a2746e60
